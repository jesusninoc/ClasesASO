- Directorio Activo
  - Añadir servidor a Controlador de Dominio (ejecutar en servidor C:\Windows\System32\Sysprep\sysprep.exe)
  - Aplicación de GPO (gpupdate /force)
```PowerShell
# Analizar GPO (en remoto y local)
# Local
# https://www.jesusninoc.com/05/12/view-group-policy-objects/
      $resulta = gpresult /z
      foreach($lineas in $resulta)
      {
          if($lineas -match "CMD")
          {
              $lineas
          }
      } 

#Remoto
    Get-GPO -All | %{
      $_ | Get-GPOReport -ReportType XML | Select-String "Impedir el acceso al símbolo del sistema"
    }
```
  - Delegación
  - Comandos
```PowerShell
# Buscar user
Get-ADObject -Filter 'ObjectClass -eq "user"' -SearchBase 'OU=usuariosPrueba,DC=Dominio,DC=Local'

# Añadir objeto contacto
New-ADObject -name Usuario -type contact -ProtectedFromAccidentalDeletion $true

# Añadir equipo
New-ADComputer -Name "PC-LAB-010" -Path "OU=Equipos,DC=empresa,DC=local" -Enabled $true

# Añadir equipo remotamente
$Cred = Get-Credential   # credencial con permisos para unir al dominio
$OU   = "OU=Equipos,DC=midominio,DC=local"
$pcs = Get-Content ".\equipos.txt"
foreach ($pc in $pcs) {
    Add-Computer -ComputerName $pc -DomainName "midominio.local" -OUPath $OU -Credential $Cred -Restart -Force
}

# Ver usuarios en OU
Get-ADUser -Path "OU=UnidadOrganizativa,DC=Dominio,DC=Local"

# Crear una OU
New-ADOrganizationalUnit -Name UnidadPS

# Crea un usuario en un lugar determinado
New-ADUSer -Name NombrePs -Sam NombreInicioSesion -Path "OU=UnidadPS,DC=jesusninoc,DC=com" -AccountPassword (ConvertTo-SecureString "Contra$ena" -AsPlainText -force) -Enable $true $SAMAccountName = "asir*" Get-ADUser -LDAPFilter "(samaccountname=$SAMAccountName)"
```
  - Orden, bloquar, aplicar, permisos
```PowerShell
Get-Command -Module GroupPolicy
New-GPO -Name "ScreenSaverTimeOut" -Comment "Sets the time to 900 seconds"
Set-GPRegistryValue -Name "ScreenSaverTimeOut" -Key "HKCU\Software\Policies\Microsoft\Windows\Control Panel\Desktop" -ValueName ScreenSaveTimeOut -Type DWord -Value 900
New-GPLink -Name "ScreenSaverTimeOut" -Target "ou=people,dc=pagr,dc=inet"

Get-GPO -Name "ScreenSaverTimeOut" | Get-GPOReport -ReportType HTML -Path $Home\report.html
Invoke-Item $Home\report.html

# Configure Advanced Settings
## Inherited Group Policies
Get-GPInheritance -Target "ou=people,dc=pagr,dc=inet"

## Blocking inheritance
Set-GPInheritance -Target "ou=people,dc=pagr,dc=inet" -IsBlocked 1

## Enforcing Group Policies
Set-GPLink -Name "Default Domain Policy" -Target "dc=pagr,dc=inet" -Enforced Yes

## Configure Security Settings
Set-GPPermission -Name "ScreenSaverTimeOut" -TargetName "Authenticated Users" -TargetType User -PermissionLevel None
Set-GPPermission -Name "ScreenSaverTimeOut" -TargetName "Authenticated Users" -TargetType User -PermissionLevel GPORead
Set-GPPermission -Name "ScreenSaverTimeOut" -TargetName "Petra" -TargetType User -PermissionLevel GPOApply
```
- IIS
  - Instalación
    - https://www.jesusninoc.com/02/15/crear-un-sitio-en-iis-con-powershell/
    - https://www.jesusninoc.com/06/28/crear-una-maquina-virtual-en-azure-con-un-windows-server-y-un-internet-information-services-iis-desde-powershell/
  - Usuarios
    - https://www.jesusninoc.com/03/02/cambiar-la-autenticacion-en-un-sitio-web-del-iis-en-windows-10/
- Cliente Nagios
- Servidor Nagios
```Bash
docker pull jasonrivers/nagios:latest
docker run --name nagios4 -p 8080:80 jasonrivers/nagios:latest
# Acceso: http://IP:8080
# Credenciales por defecto: nagiosadmin / nagios
```

--------------
--------------

# Dominios
- LDAP en modelo TCP/IP y OSI http://www.mitlinx.de/ldap/assets/osi_ldap_dap.gif
- Administración del dominio y acceso al dominio https://www.jesusninoc.com/09/01/tecnico-superior-en-administracion-de-sistemas-informaticos-en-red/#Administracion_de_dominios_Implantacion_de_sistemas_operativos
- Filtros https://www.jesusninoc.com/07/05/utilizar-un-filtro-ldap-para-verificar-la-hora-del-ultimo-inicio-de-sesion-de-los-usuarios-del-active-directory/
- Herramientas para gestionar el AD https://sid-500.com/2018/03/25/active-directory-domain-services-section-tool-for-active-directory-administrators/

# PowerShell en Linux
- Scripts en Colab https://www.jesusninoc.com/01/17/instalar-powershell-en-google-colab/
