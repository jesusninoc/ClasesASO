# Administración de servidores de impresión
- Puertos y protocolos de impresión.
- Sistemas de impresión.
- Órdenes para la gestión de impresoras y trabajos.
- Administrar las prioridades con varias colas de impresión.
- Establecer horarios de impresión para trabajos largos, etc. 

## Instalar CUPS en Ubuntu
### Ejercicio: añadir la impresora de PDF en CUPS e imprimir desde un Windows con PowerShell

## Órdenes para la gestión de impresoras y trabajos
* http://www.penguintutor.com/linux/printing-reference

### Imprimir un archivo de texto
```Bash
cat imprimir | lpr
```
### Ver cola de impresión
```Bash
lpq
```
### Borrar cola de impresión
```Bash
lprm -
```

-----------------
-----------------

# Proyecto de la unidad (aplicación sobre impresión con backdoor)
* https://www.jesusninoc.com/06/12/crear-un-formulario-en-html-y-un-fichero-en-php-que-permita-subir-una-imagen-o-fichero-o-lo-que-sea-a-un-servidor-web/
* https://www.jesusninoc.com/06/05/crear-un-servidor-web-con-un-servicio-que-permita-leer-un-codigo-qr-desde-powershell/
* https://www.jesusninoc.com/06/01/crear-y-leer-un-codigo-qr-con-un-comando-en-bash-mediante-wsl-desde-powershell/
* https://www.jesusninoc.com/05/29/enviar-cmdlets-entre-un-cliente-y-un-servidor-leyendo-de-un-fichero/
* https://www.jesusninoc.com/02/01/convertir-un-script-de-powershell-en-un-ejecutable-de-windows-convertir-un-formulario-en-powershell/

---------------
---------------

# Integración de sistemas operativos en red libres y propietarios
- Descripción de escenarios heterogéneos.
- Instalación, configuración y uso de servicios de red para compartir recursos.
- Sistemas de archivos compartidos en red
- Configuración de recursos compartidos en red.
- Protocolos para redes heterogéneas.
- Utilización de redes heterogéneas.
- Sistemas de archivos distribuidos. Replicación. 

# Ejercicio introductorio: resolver la siguiente situación. Tienes una carpeta compartida entre Windows y Linux, copias archivos a esa carpeta que se tienen que imprimir y además desparecer en cuanto se impriman.

## - How to Map Network Drives Using PowerShell
```PowerShell
New-PSDrive –Name "K" –PSProvider FileSystem –Root "\\touchsmart\share" –Persist
```
## - Smbclient
* https://access.redhat.com/documentation/es-es/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/assembly_using-the-smbclient-utility-to-access-an-smb-share_assembly_using-samba-as-a-server

## - CIFS-utils
 https://blog.desdelinux.net/samba-cifs-utils/

## - Montar unidades en Windows
* http://www.vicente-navarro.com/blog/2010/10/28/unidades-montadas-y-enlaces-simbolicos-en-windows/

## - Samba
* http://www.vicente-navarro.com/blog/2009/08/22/sambacifs-enlaces-simbolicos-y-unix-cifs-extensions/

## - Compartir una carpeta de Windows en Linux
```Bash
sudo apt install cifs-utils
sudo mkdir /mnt/share
sudo mount.cifs //Windows/SharedFolder /mnt/share -o user=account
```

## - Configuración que se realiza en los equipos Windows que acceden a la carpeta compartida en Windows
```PowerShell
New-PSDrive –Name "z" –PSProvider FileSystem –Root "\\10.20.104.38\inetpub" –Persist -Credential
z:
echo "hola" > fichero.txt
```

## - Script que imprime los archivos que aparecen en la carpeta compartida y los elimina en Windows
```PowerShell
cd C:\inetpub
ls *.txt | %{
   gc $_.Name | Out-Printer "Brother Color Leg Type1 Class Driver"
   rm $_.Name
}
```

## - Script que imprime los archivos que aparecen en la carpeta compartida y los elimina en Windows
```Bash
cd share
for f in `ls`; do lpr $f; rm $f; done
cd ..
```

--------------
--------------

# Finalizar ejercicio compartir de la semana pasada, guardar en una carpeta compartida en Linux ficheros con información de usuarios
* https://www.jesusninoc.com/01/27/creacion-de-hashes-de-contrasena-nt4/

# Nuevo ejercicio: dll que hace tareas
* https://www.jesusninoc.com/11/29/crear-compilar-y-ejecutar-una-dll-con-microsoft-visual-c-que-crear-un-usuario-desde-powershell/

----------
----------

# Integración de sistemas operativos en red libres y propietarios
- Descripción de escenarios heterogéneos.
- Instalación, configuración y uso de servicios de red para compartir recursos.
- Sistemas de archivos compartidos en red
- Configuración de recursos compartidos en red.
- Protocolos para redes heterogéneas.
- Utilización de redes heterogéneas.
- Sistemas de archivos distribuidos. Replicación. 

------------------

# Recursos compartidos en red y sistemas de archivos distribuidos
* NFS: https://www.youtube.com/watch?v=u_2gv94t1OM
* Samba: https://www.youtube.com/watch?v=V3-46MVy19s
* DFS: https://www.youtube.com/watch?v=PZnc-wtjmpo

------------------

# Scripts útiles
* https://sid-500.com/downloads/
* https://www.jesusninoc.com/02/02/instalar-herramientas-de-administracion-remota-del-servidor-rsat-para-controlar-el-directorio-activo-desde-powershell-con-windows-10/
* https://github.com/jesusninoc/Scripts

# Automatización avanzada
* https://www.jesusninoc.com/?s=FindWindowEx

# Ejemplos

## Crear usuarios y carpetas compartidas para cada uno de ellos
```PowerShell
Import-Module ActiveDirectory
Import-Csv C:\Users\Administrador\Desktop\CrearAlumnos\Mis_Usuarios.csv |%{
$nombreco=$_.FirstName + " " + $_.LastName
$ru="OU=" + $_.Curso + ",OU=FP,OU=Alumnos,OU=Usuarios,DC=retared,DC=local"
$HomeDirectory="\\alumnos\fp\" + $_.Curso + "\" + $_.sAMAccountname
mkdir $HomeDirectory
$HomeDirectory
$HomeDrive=’Q:’
New-ADUser -Name $_.FirstName -SamAccountName $_.sAMAccountname -HomeDrive $HomeDrive –HomeDirectory $HomeDirectory -DisplayName $nombreco -Enabled $true -ChangePasswordAtLogon $false -AccountPassword (ConvertTo-SecureString $_.Password -AsPlainText -force) -PassThru -UserPrincipalName $_.sAMAccountname -Path $ru
$usereta="retared\" + $_.sAMAccountname + ":F"
$HomeDirectory + "-" + $usereta
cacls $HomeDirectory /G $usereta /E
Add-ADGroupMember -Identity "CN=alumni,CN=Builtin,DC=reto,DC=local" $_.sAMAccountname
}
```

## Copiar información en un disco con BitLocker y quitar el disco (todo mediante cmdlets)
### Ayuda
#### Crear un disco virtual en Windows con PowerShell, particionar, montar y dar formato
```PowerShell
$vhdpath = "C:\VHDs\Test.vhdx"
$vhdsize = 1GB
New-VHD -Path $vhdpath -Dynamic -SizeBytes $vhdsize | Mount-VHD -Passthru |Initialize-Disk -Passthru | New-Partition -AssignDriveLetter -UseMaximumSize |Format-Volume -FileSystem NTFS -Confirm:$false -Force
```
#### Cifrar un disco con BitLocker en Windows con PowerShell 
```PowerShell
Enable-BitLocker -MountPoint "f:" -RecoveryPasswordProtector -UsedSpaceOnly -Verbose
```

-----------
-----------

# Integración de sistemas operativos en red libres y propietarios
- Descripción de escenarios heterogéneos.
- Instalación, configuración y uso de servicios de red para compartir recursos.
- Sistemas de archivos compartidos en red
- Configuración de recursos compartidos en red.
- Protocolos para redes heterogéneas.
- Utilización de redes heterogéneas.
- Sistemas de archivos distribuidos. Replicación. 

------------------

# Replicación DFS
* https://www.youtube.com/watch?v=c8wCip7KeL8
