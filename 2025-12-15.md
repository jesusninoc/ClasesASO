# Preguntas test (de todos los temas)

1. ¿Para qué sirve el comando ssh-keygen -t rsa -b 4096?
a) Para copiar archivos al servidor
b) Para generar un par de claves SSH (pública y privada) de tipo RSA de 4096 bits
c) Para cambiar la contraseña del usuario

2. En ssh-keygen -t rsa -b 4096, la opción -b 4096 indica:
a) El número de intentos de conexión
b) El tamaño en bits de la clave que se va a crear
c) El número de puertos a abrir

3. ¿Qué hace el comando ssh-copy-id usuario@ip_del_servidor?
a) Copia un archivo al servidor
b) Copia la clave privada al servidor
c) Copia la clave pública al servidor para poder iniciar sesión sin contraseña

4. Después de ejecutar ssh-copy-id usuario@ip_del_servidor correctamente, normalmente podrás:
a) Conectarte por SSH sin tener que escribir la contraseña cada vez
b) Reiniciar automáticamente el servidor
c) Cambiar la IP del servidor

5. ¿Qué hace el comando ssh usuario@ip_del_servidor?
a) Abre una sesión remota en el servidor por SSH
b) Copia archivos desde el servidor
c) Muestra la configuración de red del servidor

6. ¿Qué necesitas haber hecho antes para que ssh usuario@ip_del_servidor no pida contraseña?
a) Haber hecho ping al servidor
b) Haber ejecutado ssh-keygen y luego ssh-copy-id
c) Haber reiniciado el servicio SSH en el servidor

7. ¿Qué permite crear un túnel SSH desde el puerto 8080 local al puerto 80 de un servidor remoto?
a) Acceder al escritorio remoto
b) Redirigir el tráfico de localhost:8080 hacia el servidor remoto en su puerto 80
c) Enviar archivos por SCP

8. ¿Para qué sirve acceder al servidor remoto usando localhost:8080 tras crear el túnel?
a) Para evitar el firewall del servidor
b) Para ver el servicio web del servidor remoto como si estuviera en tu equipo
c) Para reiniciar el servidor remoto

9. ¿Qué tipo de túnel SSH permite usar el servidor remoto como salida a Internet?
a) Túnel local (L)
b) Túnel remoto (R)
c) Túnel dinámico (D), actuando como proxy SOCKS

10. ¿Qué es necesario para instalar impresoras en Windows?
a) Instalar el rol “Print and Document Services”
b) Instalar Hyper-V
c) Instalar IIS

11. ¿Cómo se denomina en Linux el sistema encargado de gestionar la impresión?
a) SMB
b) CUPS
c) NFS

12. ¿Qué comando de PowerShell muestra los trabajos enviados a una impresora?
a) Show-Printer
b) Get-PrintJob
c) Printer-List

13. En Linux, ¿qué comando permite listar las impresoras configuradas?
a) lpstat -p
b) print-list
c) lsprinter

14. ¿Para qué se utiliza principalmente LDAP?
a) Para compartir carpetas entre Windows y Linux
b) Para acceder y consultar servicios de directorio
c) Para cifrar discos duros

15. ¿Qué es Active Directory en relación con LDAP?
a) Un sistema de copias de seguridad
b) La implementación de Microsoft del estándar LDAP
c) Un servidor web de Microsoft

16. ¿Qué protocolo usa Active Directory para la autenticación segura?
a) FTP
b) Kerberos
c) HTTP

17. ¿Qué ventaja ofrece Kerberos frente a enviar la contraseña en cada conexión?
a) Usa tickets temporales y evita que la contraseña viaje por la red
b) Comprime los datos para que vayan más rápido
c) Cambia la contraseña automáticamente cada día

18. ¿Para qué se utiliza DNS en un dominio con Active Directory?
a) Para compartir impresoras
b) Para localizar controladores de dominio y servicios
c) Para instalar actualizaciones de Windows

19. ¿Qué componente en Linux actúa como “puente” con fuentes de identidad externas como AD o LDAP?
a) cron
b) SSSD
c) systemd

20. ¿Qué herramienta de Samba permite a un sistema Linux usar usuarios y grupos de Active Directory?
a) Winbind
b) NFS
c) iptables

21. ¿Qué comando ayuda a unir una máquina Linux a un dominio de forma sencilla?
a) top
b) realm (junto con adcli)
c) df

22. ¿Qué comando se utiliza para obtener un ticket Kerberos para el usuario usuario@POWER.LOCAL?
a) kinit usuario@POWER.LOCAL
b) klist usuario@POWER.LOCAL
c) ssh usuario@POWER.LOCAL

23. ¿Qué muestra el comando klist?
a) Los usuarios conectados al sistema
b) Los tickets Kerberos activos en la sesión
c) Los procesos que usan más CPU

24. ¿Qué hace el comando ldapsearch en este contexto?
a) Buscar objetos en el servicio de directorio mediante LDAP
b) Escanear puertos abiertos en la red
c) Crear usuarios en Active Directory

25. En Samba, el parámetro valid users = @grupo_docs indica que pueden acceder a la carpeta compartida:
a) Solo los usuarios invitados
b) Solo el usuario root
c) Solo los usuarios pertenecientes al grupo grupo_docs

26. ¿Qué ruta se utiliza desde Windows para acceder a la carpeta compartida docs en un servidor Samba?
a) C:\docs\servidor
b) \\<IP_DEL_SERVIDOR>\docs
c) http://<IP_DEL_SERVIDOR>/docs

27. ¿Qué comando en Linux permite comprobar si otro equipo de la red responde a nivel básico de conectividad?
a) ping <IP_DEL_EQUIPO>
b) ssh <IP_DEL_EQUIPO>
c) net use <IP_DEL_EQUIPO>

28. Si desde Windows no puedes montar \\<IP_DEL_SERVIDOR>\docs, ¿qué comando puedes usar en el servidor Linux para probar el recurso Samba localmente?
a) smbclient //127.0.0.1/docs -U usuario1
b) ftp 127.0.0.1
c) telnet 127.0.0.1 80

29. ¿Para qué sirve el comando Read-Host en PowerShell?
a) Para reiniciar un servicio
b) Para leer un dato introducido por el usuario por teclado
c) Para mostrar la lista de procesos

30. En Bash, ¿qué hace la instrucción read -p "CPU mínima: " valor?
a) Muestra el uso de CPU del sistema
b) Pide al usuario un dato y lo guarda en la variable valor
c) Ejecuta un script llamado valor

31. En PowerShell, ¿qué hace la variable $valor = Read-Host "CPU mínima"?
a) Asigna un valor fijo a la variable
b) Borra el contenido de la variable
c) Guarda en $valor lo que escriba el usuario

32. En PowerShell, ¿qué hace Get-Process?
a) Muestra los servicios instalados
b) Muestra los procesos que se están ejecutando en el sistema
c) Muestra los usuarios conectados

33. En PowerShell, ¿qué indica el operador -gt en la condición Where-Object { $_.CPU -gt $valor }?
a) Menor que
b) Igual que
c) Mayor que

34. En el comando de Bash ps -eo pid,comm,%cpu --no-headers, ¿qué hace ps?
a) Muestra procesos en ejecución
b) Muestra el espacio libre en disco
c) Muestra la configuración de red

35. En el script de Bash, ¿para qué se usa el bucle while en: ps -eo pid,comm,%cpu --no-headers | while read pid nombre cpu; do ... done?
a) Para ejecutar el script una sola vez
b) Para leer línea a línea la salida de ps y procesar cada proceso
c) Para detener todos los procesos que se muestren

36. ¿Cuál es una ventaja de usar scripts para monitorizar procesos?
a) Que siempre consumen mucha CPU
b) Que permiten automatizar comprobaciones repetitivas sin hacerlo manualmente
c) Que impiden ver los procesos del sistema

37. En un script de administración, ¿para qué sirve guardar resultados en un archivo de log?
a) Para borrar automáticamente los procesos antiguos
b) Para poder revisar después qué ha pasado y cuándo
c) Para acelerar la ejecución del script

38. En PowerShell, ¿qué hace Select-Object Id, ProcessName, CPU tras Get-Process?
a) Elimina los procesos que no usen CPU
b) Muestra únicamente las columnas Id, nombre del proceso y CPU
c) Cambia las prioridades de los procesos

39. ¿Qué hace el comando en PowerShell Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 Id, ProcessName, CPU?
a) Muestra todos los servicios instalados
b) Muestra los 5 procesos que más CPU consumen con su Id, nombre y CPU
c) Elimina los 5 procesos que más CPU usan

40. En el comando Sort-Object CPU -Descending, ¿qué significa -Descending?
a) Ordenar de menor a mayor
b) Ordenar alfabéticamente por nombre
c) Ordenar de mayor a menor

41. En Select-Object -First 5 Id, ProcessName, CPU, ¿qué hace -First 5?
a) Selecciona los últimos 5 procesos
b) Selecciona solo los 5 primeros resultados
c) Selecciona 5 procesos al azar

42. En PowerShell, ¿qué hace $servicio = Get-Service "Spooler"?
a) Instala el servicio Spooler
b) Guarda en la variable $servicio la información sobre el servicio Spooler
c) Detiene el servicio Spooler

43. En la condición if ($servicio.Status -eq "Stopped") { ... }, ¿qué comprueba el script?
a) Si el servicio está en ejecución
b) Si el servicio está detenido
c) Si el servicio está desinstalado

44. En el bloque Start-Service "Spooler", ¿qué ocurre?
a) Se desinstala el servicio Spooler
b) Se inicia el servicio Spooler si está detenido
c) Se reinicia el equipo

45. En PowerShell, ¿qué hace Get-Date?
a) Muestra solo la hora del sistema
b) Muestra la fecha y hora actuales
c) Cambia la fecha del sistema

46. En Out-File -FilePath "C:\mantenimiento.log" -Append, ¿para qué sirve -Append?
a) Sobrescribe el archivo borrando el contenido anterior
b) Añade la nueva línea al final del archivo sin borrar lo anterior
c) Crea una copia de seguridad del archivo

---------------

## Respuestas

| Nº | Pregunta (resumen) | Correcta |
|---:|---|:---:|
| 1 | ssh-keygen -t rsa -b 4096: para qué sirve | b |
| 2 | Opción -b 4096 en ssh-keygen | b |
| 3 | ssh-copy-id usuario@ip: qué hace | c |
| 4 | Tras ssh-copy-id, qué podrás hacer normalmente | a |
| 5 | ssh usuario@ip: qué hace | a |
| 6 | Para que ssh no pida contraseña, qué debes haber hecho antes | b |
| 7 | Túnel SSH 8080 local → 80 remoto: qué permite | b |
| 8 | Acceder por localhost:8080 tras el túnel: para qué sirve | b |
| 9 | Túnel para usar salida a Internet (proxy SOCKS) | c |
| 10 | Instalar impresoras en Windows: qué es necesario | a |
| 11 | Sistema de impresión en Linux | b |
| 12 | PowerShell: ver trabajos de impresión | b |
| 13 | Linux: listar impresoras configuradas | a |
| 14 | LDAP: uso principal | b |
| 15 | Active Directory respecto a LDAP | b |
| 16 | Protocolo de autenticación segura en AD | b |
| 17 | Ventaja de Kerberos | a |
| 18 | DNS en dominio con AD: para qué se usa | b |
| 19 | Linux “puente” con identidades externas (AD/LDAP) | b |
| 20 | Samba: herramienta para usar usuarios/grupos de AD | a |
| 21 | Unir Linux a dominio de forma sencilla | b |
| 22 | Obtener ticket Kerberos | a |
| 23 | klist: qué muestra | b |
| 24 | ldapsearch: qué hace | a |
| 25 | Samba valid users = @grupo_docs | c |
| 26 | Acceder desde Windows a recurso Samba docs | b |
| 27 | Comprobar conectividad básica en Linux | a |
| 28 | Probar recurso Samba localmente en servidor Linux | a |
| 29 | PowerShell Read-Host: para qué sirve | b |
| 30 | Bash read -p "CPU mínima": qué hace | b |
| 31 | $valor = Read-Host: qué hace | c |
| 32 | Get-Process: qué hace | b |
| 33 | Operador -gt en Where-Object | c |
| 34 | ps en ps -eo pid,comm,%cpu: qué hace | a |
| 35 | while read ... en el script: para qué se usa | b |
| 36 | Ventaja de usar scripts para monitorizar | b |
| 37 | Guardar resultados en log: para qué sirve | b |
| 38 | Select-Object Id, ProcessName, CPU tras Get-Process | b |
| 39 | Get-Process \| Sort-Object CPU -Descending \| Select-Object -First 5... | b |
| 40 | -Descending en Sort-Object | c |
| 41 | -First 5 en Select-Object | b |
| 42 | $servicio = Get-Service "Spooler": qué hace | b |
| 43 | if ($servicio.Status -eq "Stopped")...: qué comprueba | b |
| 44 | Start-Service "Spooler": qué ocurre | b |
| 45 | Get-Date: qué hace | b |
| 46 | -Append en Out-File: para qué sirve | b |

-------------
-------------

# Scripting
- Curso acelerado de PowerShell https://www.jesusninoc.com/11/22/curso-online-de-powershell-diciembre-2025/
- Cron y tarea programada.
- Copias de seguridad
```PowerShell
# Actividad: Programación de backups automáticos en Windows con PowerShell
# Este script:
#  - Comprime C:\Users en un ZIP con la fecha en el nombre
#  - Guarda el backup en D:\backups
#  - Añade una entrada a un archivo de log
#  - BONUS: Verifica con Test-Path y envía correo si el backup falla

# Carpeta de origen que se va a comprimir
$Origen  = "C:\Users"

# Carpeta de destino donde se guardarán los backups
$Destino = "D:\backups"

# Crear la carpeta de destino si no existe (Test-Path + New-Item)
if (-not (Test-Path $Destino)) {
    New-Item -ItemType Directory -Path $Destino | Out-Null
}

# Fecha en formato YYYY-MM-DD para el nombre del ZIP
$Fecha = Get-Date -Format "yyyy-MM-dd"

# Ruta completa del archivo ZIP de backup
$Zip   = Join-Path $Destino "backup-$Fecha.zip"

# Archivo de log donde se registran los resultados
$Log   = Join-Path $Destino "backup_diario.log"

# Configuración básica de correo (adaptar a cada entorno)
# Estos datos son de ejemplo y deben cambiarse por valores reales
$MailTo     = "admin@midominio.com"      # Destinatario del correo
$MailFrom   = "backup@midominio.com"     # Remitente del correo
$SmtpServer = "smtp.midominio.com"       # Servidor SMTP

# Comprimir la carpeta de usuarios en un ZIP (Compress-Archive)
Compress-Archive -Path $Origen -DestinationPath $Zip -Force

# Verificar con Test-Path si el fichero de backup se ha creado correctamente
if (Test-Path $Zip) {
    # Mensaje de log en caso de éxito
    $Mensaje = "$(Get-Date): Backup correcto en $Zip"
} else {
    # Mensaje de log en caso de error
    $Mensaje = "$(Get-Date): ERROR: no se ha creado el backup en $Zip"

    # BONUS: Enviar notificación por correo si el backup falla
    try {
        Send-MailMessage -To $MailTo -From $MailFrom -Subject "ERROR en backup diario" `
            -Body $Mensaje -SmtpServer $SmtpServer
    } catch {
        # Si falla el envío de correo, añadir también el error al log
        $Mensaje += " (además, error al enviar correo: $($_.Exception.Message))"
    }
}

# Escribir el mensaje (éxito o error) en el archivo de log
$Mensaje | Out-File -FilePath $Log -Append

# Ejemplo de programación en el Programador de tareas (Task Scheduler):
#  - Acción: Iniciar un programa
#  - Programa: powershell.exe
#  - Argumentos: -File "C:\Scripts\backup_diario.ps1"
#  - Hora de ejecución diaria: 23:00
```
